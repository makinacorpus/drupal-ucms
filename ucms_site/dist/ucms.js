!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=(n.n(r),n(2)),o=(n.n(a),n(3));n.n(o)},function(e,t){},function(e,t,n){"use strict";Drupal.behaviors.UcmsInit={}},function(e,t,n){"use strict";function r(e,t){for(var n=0,r=t.querySelectorAll('input[type="text"]');n<r.length;n++){r[n].onchange=function(){return l(e)}}for(var a=0,o=t.querySelectorAll("span.fa-times");a<o.length;a++){var i=o[a];!function(t){t.onclick=function(){for(var n=t;n.parentElement;)if(n=n.parentElement,"li"===n.tagName.toLowerCase())return n.parentElement&&n.parentElement.removeChild(n),void l(e)}}(i)}}function a(e){for(var t=e.getAttribute(c.DATA_ITEM_ID),n="",r=0,a=["h1","h2","h3","h4"];r<a.length;r++){var o=a[r],i=e.querySelector(o);if(i&&i.textContent){n=i.textContent;break}}var l=document.createElement("div"),u=p.replace("__ITEM_ID__",t).replace("__TITLE__",n).trim();return l.innerHTML=u,l.childNodes[0]}function o(e,t,n){var o=a(t),i=o.querySelector("ol");return i&&n.containers.push(i),r(e,o.parentElement?o.parentElement:o),o.setAttribute("data-tree-transformed","1"),o.classList.add("tree-new"),o}function i(e){return"ol"===e.tagName.toLowerCase()}function l(e){var t=e.querySelector('input[name="values"]');if(!t)throw"Cannot update form state";var n=e.querySelector("ol.sortable");if(!n)throw"Could not find menu root";var r=0,a=[],o=function(e,t){for(var n=0,i=e.childNodes;n<i.length;n++){var l=i[n];if(l instanceof Element&&c.elementMatches(l,"node")){if(l.classList.contains("gu-transit"))continue;var u=l.querySelector('input[type="text"]'),s=void 0;s=u instanceof HTMLInputElement?u.value:"";var d=l.getAttribute(c.DATA_ITEM_TYPE),f=l.getAttribute(c.DATA_ITEM_ID),m=l.getAttribute("data-mlid");m&&"new_"!==m.substr(0,4)||(r+=1,m="new_"+r,l.setAttribute("data-mlid",m)),a.push({item_type:d,item_id:f,parent_id:t,id:m,title:s});var p=l.querySelector("ol");p&&o(p,m)}}};o(n,""),t.setAttribute("value",JSON.stringify(a))}function u(e){if(m.length&&e.length)for(var t=0,n=e;t<n.length;t++){var r=n[t],a=r.element;if(!a.hasAttribute("data-tree-enabled")){a.setAttribute("data-tree-enabled","1");for(var o=0,i=m;o<i.length;o++){var l=i[o];l.containers.push(a)}}}}function s(e){var t=[],n=e.querySelector(f);if(!n)throw"Could not find root item";for(var u=0,s=e.querySelectorAll(d);u<s.length;u++){var p=s[u],v=p.querySelector("ol");p.setAttribute("data-tree-transformed","1"),v||(v=document.createElement("ol"),v.setAttribute("class","empty"),p.appendChild(v)),t.push(v)}t.push(n),r(e,e),l(e);var _,A,h=dragula(t,{copy:function(e,t){return"ol"!==t.tagName.toLowerCase()},accepts:function(e,t){return"ol"===t.tagName.toLowerCase()&&c.elementMatches(e,"node")},revertOnSpill:!0,removeOnSpill:!1,direction:"vertical"});h.on("drag",function(e,t){_=e,i(t)||(A=a(e),A.classList.add("gu-transit"))}),h.on("dragend",function(e){_&&_.removeAttribute("style"),_=null,A&&A.parentNode&&A.parentNode.removeChild(A),A=null}),h.on("over",function(e,t,n){i(t)&&A&&e.parentElement&&(e.setAttribute("style","display: none !important;"),e.parentElement.insertBefore(A,e))}),h.on("shadow",function(e,t,n){i(t)&&A&&e.parentElement&&e.parentElement.insertBefore(A,e)}),h.on("drop",function(t,n,r){if(i(r))r.childElementCount||r.classList.add("empty"),t.classList.contains("tree-new")||t.classList.add("tree-modified"),t.classList.contains("gu-transit")&&t.classList.remove("gu-transit");else{var a=o(e,t,h);t.parentNode&&t.parentNode.replaceChild(a,t)}n.classList.remove("empty"),l(e)}),m.push(h)}Object.defineProperty(t,"__esModule",{value:!0});var c=n(4),d="[data-mlid]",f="[data-menu]",m=[],p='\n    <li data-item-type="node" data-item-id="__ITEM_ID__">\n      <div class="tree-item clearfix">\n        <input class="form-control form-text" value="__TITLE__" maxlength="128" type="text"/>\n        <span class="fa fa-times"></span>\n      </div>\n      <ol class="empty"></ol>\n    </li>\n';Drupal.behaviors.UcmsTree={attach:function(e){if(!e.querySelectorAll){if(!e.get)return;e=e.get(0)}for(var t=0,n=e.querySelectorAll("#ucms-tree-tree-form");t<n.length;t++){s(n[t])}u(c.findAllSourcesIn(e))}}},function(e,t,n){"use strict";function r(){for(var e=[],n=0,r=document.querySelectorAll(t.SELECTOR_SOURCES);n<r.length;n++){var a=r[n];e.push(new i(a))}return e}function a(e){for(var n=[],r=0,a=e.querySelectorAll(t.SELECTOR_SOURCES);r<a.length;r++){var o=a[r];n.push(new i(o))}return n}function o(e,n,r){if(!e.hasAttribute(t.DATA_ITEM_ID)||!e.hasAttribute(t.DATA_ITEM_TYPE))return!1;if(n&&n!==e.getAttribute(t.DATA_ITEM_TYPE))return!1;if(r){if(!e.hasAttribute(t.DATA_ITEM_BUNDLE))return!1;var a=e.getAttribute(t.DATA_ITEM_BUNDLE);return!!a&&-1!==r.indexOf(a)}return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.DATA_BUNDLES="data-allowed-bundles",t.DATA_ITEM_BUNDLE="data-item-bundle",t.DATA_ITEM_ID="data-item-id",t.DATA_ITEM_TYPE="data-item-type",t.SELECTOR_SOURCES='[data-layout-source="1"]';var i=function(){function e(e){this.element=e}return e}();t.Source=i,t.findAllSourcesInDocument=r,t.findAllSourcesIn=a,t.elementMatches=o}]);
//# sourceMappingURL=ucms.js.map