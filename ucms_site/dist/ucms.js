!function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=(r.n(n),r(2)),i=(r.n(a),r(3)),o=(r.n(i),r(4)),u=(r.n(o),r(5));r.n(u)},function(e,t){},function(e,t,r){"use strict";var n;!function(e){function t(){for(var t=[],r=0,n=document.querySelectorAll(e.SELECTOR_SOURCES);r<n.length;r++){var i=n[r];t.push(new a(i))}return t}function r(t){for(var r=[],n=0,i=t.querySelectorAll(e.SELECTOR_SOURCES);n<i.length;n++){var o=i[n];r.push(new a(o))}return r}function n(t,r,n){if(!t.hasAttribute(e.DATA_ITEM_ID)||!t.hasAttribute(e.DATA_ITEM_TYPE))return!1;if(r&&r!==t.getAttribute(e.DATA_ITEM_TYPE))return!1;if(n){if(!t.hasAttribute(e.DATA_ITEM_BUNDLE))return!1;var a=t.getAttribute(e.DATA_ITEM_BUNDLE);return!!a&&-1!==n.indexOf(a)}return!0}e.DATA_BUNDLES="data-allowed-bundles",e.DATA_ITEM_BUNDLE="data-item-bundle",e.DATA_ITEM_ID="data-item-id",e.DATA_ITEM_TYPE="data-item-type",e.SELECTOR_SOURCES='[data-layout-source="1"]';var a=function(){function e(e){this.element=e}return e}();e.Source=a,e.findAllSourcesInDocument=t,e.findAllSourcesIn=r,e.elementMatches=n}(n||(n={}))},function(e,t,r){"use strict";Drupal.behaviors.UcmsInit={}},function(e,t,r){"use strict";var n;!function(e){function t(e,t){for(var r=0,n=t.querySelectorAll('input[type="text"]');r<n.length;r++){n[r].onchange=function(){return i(e)}}for(var a=0,o=t.querySelectorAll("span.fa-times");a<o.length;a++){var u=o[a];!function(t){t.onclick=function(){for(var r=t;r.parentElement;)if(r=r.parentElement,"li"===r.tagName.toLowerCase())return r.parentElement&&r.parentElement.removeChild(r),void i(e)}}(u)}}function r(e){for(var t=e.getAttribute(DragSources.DATA_ITEM_ID),r="",n=0,a=["h1","h2","h3","h4"];n<a.length;n++){var i=a[n],o=e.querySelector(i);if(o&&o.textContent){r=o.textContent;break}}var u=document.createElement("div"),l=s.replace("__ITEM_ID__",t).replace("__TITLE__",r).trim();return u.innerHTML=l,u.childNodes[0]}function n(e,n,a){var i=r(n),o=i.querySelector("ol");return o&&a.containers.push(o),t(e,i.parentElement?i.parentElement:i),i.setAttribute("data-tree-transformed","1"),i.classList.add("tree-new"),i}function a(e){return"ol"===e.tagName.toLowerCase()}function i(e){var t=e.querySelector('input[name="values"]');if(!t)throw"Cannot update form state";var r=e.querySelector("ol.sortable");if(!r)throw"Could not find menu root";var n=0,a=[],i=function(e,t){for(var r=0,o=e.childNodes;r<o.length;r++){var u=o[r];if(u instanceof Element&&DragSources.elementMatches(u,"node")){if(u.classList.contains("gu-transit"))continue;var l=u.querySelector('input[type="text"]'),s=void 0;s=l instanceof HTMLInputElement?l.value:"";var c=u.getAttribute(DragSources.DATA_ITEM_TYPE),f=u.getAttribute(DragSources.DATA_ITEM_ID),d=u.getAttribute("data-mlid");d&&"new_"!==d.substr(0,4)||(n+=1,d="new_"+n,u.setAttribute("data-mlid",d)),a.push({item_type:c,item_id:f,parent_id:t,id:d,title:s});var m=u.querySelector("ol");m&&i(m,d)}}};i(r,""),t.setAttribute("value",JSON.stringify(a))}function o(e){if(l.length&&e.length)for(var t=0,r=e;t<r.length;t++){var n=r[t],a=n.element;if(!a.hasAttribute("data-tree-enabled")){a.setAttribute("data-tree-enabled","1");for(var i=0,o=l;i<o.length;i++){var u=o[i];u.containers.push(a)}}}}function u(o){var u=[],s=o.querySelector(e.SELECTOR_ROOT);if(!s)throw"Could not find root item";for(var c=0,f=o.querySelectorAll(e.SELECTOR_ITEM);c<f.length;c++){var d=f[c],m=d.querySelector("ol");d.setAttribute("data-tree-transformed","1"),m||(m=document.createElement("ol"),m.setAttribute("class","empty"),d.appendChild(m)),u.push(m)}u.push(s),t(o,o),i(o);var p,E,v=dragula(u,{copy:function(e,t){return"ol"!==t.tagName.toLowerCase()},accepts:function(e,t){return"ol"===t.tagName.toLowerCase()&&DragSources.elementMatches(e,"node")},revertOnSpill:!0,removeOnSpill:!1,direction:"vertical"});v.on("drag",function(e,t){p=e,a(t)||(E=r(e),E.classList.add("gu-transit"))}),v.on("dragend",function(e){p&&p.removeAttribute("style"),p=null,E&&E.parentNode&&E.parentNode.removeChild(E),E=null}),v.on("over",function(e,t,r){a(t)&&E&&e.parentElement&&(e.setAttribute("style","display: none !important;"),e.parentElement.insertBefore(E,e))}),v.on("shadow",function(e,t,r){a(t)&&E&&e.parentElement&&e.parentElement.insertBefore(E,e)}),v.on("drop",function(e,t,r){if(a(r))r.childElementCount||r.classList.add("empty"),e.classList.contains("tree-new")||e.classList.add("tree-modified"),e.classList.contains("gu-transit")&&e.classList.remove("gu-transit");else{var u=n(o,e,v);e.parentNode&&e.parentNode.replaceChild(u,e)}t.classList.remove("empty"),i(o)}),l.push(v)}e.SELECTOR_ITEM="[data-mlid]",e.SELECTOR_ROOT="[data-menu]",e.SELECTOR_WIDGET="#ucms-tree-tree-form";var l=[],s='<li data-item-type="node" data-item-id="__ITEM_ID__"><div class="tree-item clearfix"><input class="form-control form-text" value="__TITLE__" maxlength="128" type="text"/><span class="fa fa-times"></span></div><ol class="empty"></ol></li>';e.intializeSources=o,e.initializeWidget=u}(n||(n={}))},function(e,t,r){"use strict";Drupal.behaviors.UcmsTree={attach:function(e){if(!e.querySelectorAll){if(!e.get)return;e=e.get(0)}for(var t=0,r=e.querySelectorAll(UcmsTree.SELECTOR_WIDGET);t<r.length;t++){var n=r[t];UcmsTree.initializeWidget(n)}UcmsTree.intializeSources(DragSources.findAllSourcesIn(e))}}}]);
//# sourceMappingURL=ucms.js.map