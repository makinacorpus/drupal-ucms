services:

  ucms_label.manager:
    class: MakinaCorpus\Ucms\Label\LabelManager
    arguments: ["@database", "@entity.manager"]

  ucms_label.admin.datasource:
    class: MakinaCorpus\Ucms\Label\Page\LabelAdminDatasource
    arguments: ["@database", "@ucms_label.manager"]

  ucms_label.label_action_provider:
    public: false
    class: MakinaCorpus\Ucms\Label\Action\LabelActionProvider
    arguments: ["@ucms_label.manager", "@ucms_notification.service", "@current_user"]
    tags: [{name: ucms_dashboard.action_provider}]

  ucms_label.context_pane_event_listener:
    class: MakinaCorpus\Ucms\Label\EventDispatcher\ContextPaneEventListener
    arguments: ["@ucms_label.manager"]
    tags:
      - { name: event_listener, event: ucms_dashboard.context_init }

  ucms_label.label_event_listener:
    class: MakinaCorpus\Ucms\Label\EventDispatcher\LabelEventListener
    arguments: ["@ucms_label.manager", "@apb.notification"]
    tags:
      - { name: event_listener, event: "label:add" }
      - { name: event_listener, event: "label:edit" }
      - { name: event_listener, event: "label:delete" }

  ucms_label.node_event_listener:
    class: MakinaCorpus\Ucms\Label\EventDispatcher\NodeEventListener
    arguments: ["@entity.manager"]
    tags:
      - { name: event_listener, event: "node:add" }
      #- { name: event_listener, event: "node:edit" }
      #- { name: event_listener, event: "node:delete" }
      - { name: event_listener, event: "node:new_labels" }