parameters:
  ucms_tree_site_menu:
    site-main: Main menu
    site-footer: Footer menu

services:

  ucms_tree.menu_access:
    public: true
    class: MakinaCorpus\Ucms\Tree\MenuAccess
    arguments: ['@ucms_site.manager']

  ucms_tree.site_event_listener:
    public: true
    class: MakinaCorpus\Ucms\Tree\EventDispatcher\SiteEventListener
    arguments: ["@database", "@ucms_site.manager", "%ucms_tree_site_menu%"]
    tags:
      - {name: event_listener, event: "site:create"}
      - {name: event_listener, event: "site:init"}
      - {name: event_listener, event: "site:clone"}

  ucms_tree.node_event_subscriber:
    public: true
    class: MakinaCorpus\Ucms\Tree\EventDispatcher\NodeEventSubscriber
    arguments: ["@database", "@ucms_seo.seo_service", "@ucms_site.manager", "@ucms_seo.store_locator_factory"]
    tags: [{ name: event_subscriber }]

  # Administrative components
  ucms_tree.admin.datasource:
    public: true
    class: MakinaCorpus\Ucms\Tree\Page\TreeAdminDatasource
    arguments: ["@umenu.menu_storage", "@ucms_site.manager", "@current_user"]
  ucms_tree.admin.display:
    public: true
    class: MakinaCorpus\Ucms\Tree\Page\TreeAdminDisplay
    arguments: ["@ucms_site.manager"]

  # Action processors and providers
  ucms_tree.action.tree_delete:
    public: false
    class: MakinaCorpus\Ucms\Tree\Action\TreeDeleteProcessor
    arguments: ["@umenu.menu_storage", "@ucms_site.manager", "@current_user"]
    tags: [{name: ucms_dashboard.action}]
  ucms_tree.action.tree_set_main:
    public: false
    class: MakinaCorpus\Ucms\Tree\Action\TreeSetMainProcessor
    arguments: ["@umenu.menu_storage", "@ucms_site.manager", "@current_user"]
    tags: [{name: ucms_dashboard.action}]
  ucms_tree.tree_action_provider:
    public: false
    class: MakinaCorpus\Ucms\Tree\Action\TreeActionProvider
    arguments: ["@ucms_site.manager", "@current_user"]
    tags: [{name: ucms_dashboard.action_provider}]