parameters:
  ucms_tree_site_menu:
    site-main: Main menu
    site-footer: Footer menu

services:

  ucms_tree.context_pane_event_listener:
    class: MakinaCorpus\Ucms\Tree\EventDispatcher\ContextPaneEventListener
    arguments: ["@ucms_site.manager", "@umenu.manager"]
    tags:
      - { name: event_listener, event: ucms_dashboard.context_init }


  ucms_tree.site_event_listener:
    class: MakinaCorpus\Ucms\Tree\EventDispatcher\SiteEventListener
    arguments: ["@database", "@ucms_site.manager", "%ucms_tree_site_menu%"]
    tags:
      - {name: event_listener, event: "site:create"}
      - {name: event_listener, event: "site:init"}
      - {name: event_listener, event: "site:clone"}

  ucms_tree.node_event_subscriber:
    class: MakinaCorpus\Ucms\Tree\EventDispatcher\NodeEventSubscriber
    arguments: ["@database", "@ucms_seo.seo_service", "@ucms_site.manager", "@ucms_seo.store_locator_factory"]
    tags: [{ name: event_subscriber }]

  # Administrative components
  ucms_tree.admin.datasource:
    class: MakinaCorpus\Ucms\Tree\Page\TreeAdminDatasource
    arguments: ["@umenu.menu_storage", "@ucms_site.manager", "@current_user"]
  ucms_tree.admin.display:
    class: MakinaCorpus\Ucms\Tree\Page\TreeAdminDisplay
    arguments: ["@ucms_site.manager"]

  # Action processors
  ucms_tree.action.tree_delete:
    public: false
    class: MakinaCorpus\Ucms\Tree\Action\TreeDeleteProcessor
    arguments: ["@umenu.menu_storage", "@ucms_site.manager", "@current_user"]
    tags: [{name: ucms_dashboard.action}]
